|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
|       |                            |       Haswell |               |              |              |           |           |               |                |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
| Layer | Topology                   | MKL-DNN (fwd) | MKL-DNN (bwd) | ZNNphi (fwd) | ZNNPhi (bwd) | CcT (fwd) | CcT (bwd) | MKL2017 (fwd) | MKL 2017 (bwd) |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
| Conv2 | 64x112x112  -> 128x112x112 |       79.1275 |       196.401 |      31.3164 |     79.0901x |   141.209 |   317.833 |       43.7455 |         99.285 |
| Conv3 | 128x56x56   -> 256x56x56   |       42.3746 |       106.796 |      24.4811 |     61.5185x |   118.521 |    194.27 |       29.9454 |        78.4889 |
| Conv4 | 256x56x56   -> 256x56x56   |       101.276 |       322.293 |      48.5320 |    115.0899x |   263.519 |   395.418 |       58.5886 |        158.027 |
| Conv5 | 256x28x28   -> 512x28x28   |        44.226 |       203.507 |      24.3492 |     60.6804x |   92.5641 |    233.93 |       27.3278 |        76.2447 |
| Conv6 | 512x28x28   -> 512x28x28   |       89.8072 |       466.538 |      48.4712 |    115.6594x |   196.814 |   466.345 |       51.8565 |        149.924 |
| Conv7 | 512x14x14   -> 512x14x14   |       21.0151 |        175.31 |      12.8897 |     33.2321x |   47.4143 |    237.32 |       14.7956 |        37.1315 |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|



OxfordNet VGG-a (Batch of 64)

Forward pass (6 core Xeon)

|-------+----------------------------+---------+--------+-----------|
| Layer | Topology                   | MKL-DNN | ZNNPhi | Caffe CcT |
|-------+----------------------------+---------+--------+-----------|
| Conv1 | 3x224x224   -> 64x224x224  |     158 |     79 |       616 |
| Conv2 | 64x112x112  -> 128x112x112 |     366 |    244 |       861 |
| Conv3 | 128x56x56   -> 256x56x56   |     280 |    226 |       644 |
| Conv4 | 256x56x56   -> 256x56x56   |     546 |    451 |      1177 |
| Conv5 | 256x28x28   -> 512x28x28   |     241 |    247 |       491 |
|-------+----------------------------+---------+--------+-----------|

Backward + Update pass (6 core Xeon)

|-------+----------------------------+---------+--------+-----------|
| Layer | Topology                   | MKL-DNN | ZNNPhi | Caffe CcT |
|-------+----------------------------+---------+--------+-----------|
| Conv1 | 3x224x224   -> 64x224x224  |     185 |    102 |       567 |
| Conv2 | 64x112x112  -> 128x112x112 |     708 |    543 |      1221 |
| Conv3 | 128x56x56   -> 256x56x56   |     549 |    468 |      1175 |
| Conv4 | 256x56x56   -> 256x56x56   |    1088 |    911 |      2035 |
| Conv5 | 256x28x28   -> 512x28x28   |     507 |    510 |      1077 |
|-------+----------------------------+---------+--------+-----------|

Haswell

|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
|       |                            |       Haswell |               |              |              |           |           |               |                |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
| Layer | Topology                   | MKL-DNN (fwd) | MKL-DNN (bwd) | ZNNphi (fwd) | ZNNPhi (bwd) | CcT (fwd) | CcT (bwd) | MKL2017 (fwd) | MKL 2017 (bwd) |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
| Conv2 | 64x112x112  -> 128x112x112 |       79.1275 |       196.401 |       42.875 |      79.0901 |   141.209 |   317.833 |       43.7455 |         99.285 |
| Conv3 | 128x56x56   -> 256x56x56   |       42.3746 |       106.796 |      29.3154 |      61.5185 |   118.521 |    194.27 |       29.9454 |        78.4889 |
| Conv4 | 256x56x56   -> 256x56x56   |       101.276 |       322.293 |      54.0394 |     115.0899 |   263.519 |   395.418 |       58.5886 |        158.027 |
| Conv5 | 256x28x28   -> 512x28x28   |        44.226 |       203.507 |      27.9326 |      60.6804 |   92.5641 |    233.93 |       27.3278 |        76.2447 |
| Conv6 | 512x28x28   -> 512x28x28   |       89.8072 |       466.538 |      51.2921 |     115.6594 |   196.814 |   466.345 |       51.8565 |        149.924 |
| Conv7 | 512x14x14   -> 512x14x14   |       21.0151 |        175.31 |      15.3210 |      33.2321 |   47.4143 |    237.32 |       14.7956 |        37.1315 |
| Conv8 | ------ SAME ------         |       23.0235 |       173.278 |      15.2122 |      32.9128 |   43.3761 |   251.593 |       15.0066 |        37.0637 |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|


Skylake

|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
|       |                            | Skylake       |               |              |              |           |           |               |                |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
| Layer | Topology                   | MKL-DNN (fwd) | MKL-DNN (bwd) | ZNNphi (fwd) | ZNNPhi (bwd) | CcT (fwd) | CcT (bwd) | MKL2017 (fwd) | MKL 2017 (bwd) |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|
| Conv2 | 64x112x112  -> 128x112x112 |               |               | x284.422     | x545.775     |           |           |       287.338 |        679.463 |
| Conv3 | 128x56x56   -> 256x56x56   |               |               | 239.701      | x503.335     |           |           |       260.693 |        640.042 |
| Conv4 | 256x56x56   -> 256x56x56   |               |               | 518.212      | x1032.10     |           |           |       510.135 |        1274.52 |
| Conv5 | 256x28x28   -> 512x28x28   |               |               | x230.080     | x511.092     |           |           |        239.25 |         629.07 |
| Conv6 | 512x28x28   -> 512x28x28   |               |               | x473.644     | x1002.32     |           |           |       475.768 |        1257.09 |
| Conv7 | 512x14x14   -> 512x14x14   |               |               | x98.9562     | x212.842     |           |           |       118.561 |        318.599 |
| Conv8 | ------ SAME ------         |               |               |              |              |           |           |               |                |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+----------------|



|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+---------------|
|       |                            |           KNL |               |              |              |           |           |               |               |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+---------------|
| Layer | Topology                   | MKL-DNN (fwd) | MKL-DNN (bwd) | ZNNphi (fwd) | ZNNPhi (bwd) | CcT (fwd) | CcT (bwd) | MKL2017 (fwd) | MKL2017 (bwd) |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+---------------|
| Conv2 | 64x112x112  -> 128x112x112 |       108.322 |       273.503 |      36.3461 |      87.0676 |           |           |       35.0835 |       98.5914 |
| Conv3 | 128x56x56   -> 256x56x56   |       78.1759 |       207.873 |      36.8031 |       80.794 |           |           |       33.1814 |       80.1999 |
| Conv4 | 256x56x56   -> 256x56x56   |       155.878 |       438.483 |      71.4921 |     155.6885 |           |           |       65.2466 |       157.363 |
| Conv5 | 256x28x28   -> 512x28x28   |       61.5696 |       271.382 |      41.1453 |      78.7302 |           |           |        30.779 |       71.8266 |
| Conv6 | 512x28x28   -> 512x28x28   |       122.749 |       568.182 |      67.4201 |     148.5549 |           |           |       60.8869 |       143.832 |
| Conv7 | 512x14x14   -> 512x14x14   |       43.2439 |       362.472 |              |              |           |           |       15.4321 |       39.5017 |
| Conv8 | ------ SAME ------         |       43.7978 |       370.272 |              |              |           |           |       15.5519 |       40.2116 |
|-------+----------------------------+---------------+---------------+--------------+--------------+-----------+-----------+---------------+---------------|

VD2D3D

|--------+---+----+----+----------------+-----------+-----------|
| Layer  | N |  f | f' | Size           | Padding   | Kernel    |
|--------+---+----+----+----------------+-----------+-----------|
| Conv1b | 1 | 32 | 32 | 10 \times 234 \times 234 | 0 \times 0 \times 0 | 1 \times 3 \times 3 |
| Conv1c | 1 | 32 | 32 | 10 \times 232 \times 232 | 0 \times 0 \times 0 | 1 \times 3 \times 3 |
| Conv2a | 4 | 32 | 48 | 5 \times 115 \times 115  | 0 \times 0 \times 0 | 1 \times 3 \times 3 |
| Conv2b | 4 | 48 | 48 | 5 \times 113 \times 113  | 0 \times 0 \times 0 | 1 \times 3 \times 3 |
| Conv3a | 4 | 48 | 64 | 5 \times 109 \times 109  | 0 \times 0 \times 0 | 2 \times 3 \times 3 |
| Conv3b | 4 | 64 | 64 | 4 \times 107 \times 107  | 0 \times 0 \times 0 | 2 \times 3 \times 3 |
| Conv4a | 4 | 64 | 64 | 3 \times 104 \times 104  | 0 \times 0 \times 0 | 2 \times 3 \times 3 |
| Conv4b | 4 | 64 | 64 | 2 \times 102 \times 102  | 0 \times 0 \times 0 | 2 \times 3 \times 3 |
|--------+---+----+----+----------------+-----------+-----------|

VGG-A

|-------+----+-----+-----+-----------+---------+--------|
| Layer |  N |   f |  f' | Size      | Padding | Kernel |
|-------+----+-----+-----+-----------+---------+--------|
| Conv2 | 64 |  64 | 128 | 112 \times 112 | 1 \times 1   | 3 \times 3  |
| Conv3 | 64 | 128 | 256 | 56 \times 56   | 1 \times 1   | 3 \times 3  |
| Conv4 | 64 | 256 | 256 | 56 \times 56   | 1 \times 1   | 3 \times 3  |
| Conv5 | 64 | 256 | 512 | 28 \times 28   | 1 \times 1   | 3 \times 3  |
| Conv6 | 64 | 512 | 512 | 28 \times 28   | 1 \times 1   | 3 \times 3  |
| Conv7 | 64 | 512 | 512 | 14 \times 14   | 1 \times 1   | 3 \times 3  |
| Conv8 | 64 | 512 | 512 | 14 \times 14   | 1 \times 1   | 3 \times 3  |
|-------+----+-----+-----+-----------+---------+--------|

UNET

|--------+---+------+------+-----------+---------+--------|
| Layer  | N |    f |   f' | Size      | Padding | Kernel |
|--------+---+------+------+-----------+---------+--------|
| Conv1b | 1 |   64 |   64 | 570 \times 570 | 0 \times 0   | 3 \times 3  |
| Conv2a | 1 |   64 |  128 | 284 \times 284 | 0 \times 0   | 3 \times 3  |
| Conv2b | 1 |  128 |  128 | 282 \times 282 | 0 \times 0   | 3 \times 3  |
| Conv3a | 1 |  128 |  256 | 140 \times 140 | 0 \times 0   | 3 \times 3  |
| Conv3b | 1 |  256 |  256 | 138 \times 138 | 0 \times 0   | 3 \times 3  |
| Conv4a | 1 |  256 |  512 | 68 \times 68   | 0 \times 0   | 3 \times 3  |
| Conv4b | 1 |  512 |  512 | 66 \times 66   | 0 \times 0   | 3 \times 3  |
| Conv5a | 1 |  512 | 1024 | 32 \times 32   | 0 \times 0   | 3 \times 3  |
| Conv5b | 1 | 1024 | 1024 | 30 \times 30   | 0 \times 0   | 3 \times 3  |
|--------+---+------+------+-----------+---------+--------|



https://arxiv.org/pdf/1412.0767.pdf

GFLOPs/s

|--------------+--------------+----------+---------+----------------|
|              | Xeon Haswell | Xeon Phi | Titan X | Titan X Pascal |
|--------------+--------------+----------+---------+----------------|
| peak FLOPS/s |         5760 |   4505.6 |    6600 |          11000 |
|--------------+--------------+----------+---------+----------------|

|-------+----+-----+-----+----------+--------+--------------+----------+---------+----------------|
| Layer |  N |   f |  f' |     Size | Kernel | Xeon Haswell | Xeon Phi | Titan X | Titan X Pascal |
|-------+----+-----+-----+----------+--------+--------------+----------+---------+----------------|
| 2a    | 32 |  64 | 128 | 16x56x56 |  3x3x3 |      4484.23 |   3135.6 |  751.24 |        4793.91 |
| 3a    | 32 | 128 | 256 | 12x27x27 |  3x3x3 |      4506.52 |   3138.4 | 815.042 |        4316.32 |
| 3b    | 32 | 256 | 256 | 10x25x25 |  3x3x3 |              |          |         |                |
| 4a    | 32 | 256 | 256 |  8x23x23 |  3x3x3 |              |          |         |                |
| 4b    | 32 | 256 | 512 |          |        |              |          |         |                |
