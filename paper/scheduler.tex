\section{Static scheduler}

  Let $M = (I, D)$ be a serial method that executes instructions $I$
  on data $D$ (e.g. $I$ is a compiled method that receives a set of
  arguments $D$.

  A serial program can be represented as an ordered list of methods $P
  = (M_0, M_1, \dots, M_k)$.  Our goal is to generate $C$ parallel
  programs $P_0, P_1, \dots, P_{C-1}$, such that for each $0 \le i < j
  < C$ the following two claims are true.

  \begin{enumerate}
    \item Programs $P_i$ and $P_j$ do not write to the same memory
      location.
    \item The first $K$ methods of both $P_i$ and $P_j$ have the same
      instructions, where $K$ equals the minimum of the number of
      procedures in both programs.
  \end{enumerate}

  In addition, we would like to minimize the complexity of each
  program.

  \subsection{Meta--algorithm}

  $\proc{function} \langle B, F, F', I_d, I_h, I_w, W_d, W_h, W_w \rangle ( i, o, w, b )$


  \begin{algorithm}
    {\footnotesize
      \begin{codebox}
        \Procname{$\proc{Schedule} \langle T, B, F, F',\vec{I},\vec{K} \rangle(t,i,o,w,b)$}
        \li $\vec{n}' = \vec{n} - \vec{k} + \vec{1}$
        \li $O \gets \proc{5D-Real-Tensor}(S,f',n'_x,n'_y,n'_z)$
        \li \kw{parallel for} $i \gets 0 \To S-1$
        \li   \Do \kw{parallel for} $j \gets 0 \To f'-1$
        \li     \Do \For $k \gets 0 \To f-1$
        \li     \Do $O_{i,j} \gets O_{i,j} + \proc{Convolve}(I_{i,k},w_{j,k})$
        \End \End \End
        \li $\proc{Free-Memory}(I)$
        \li \Return $O$
      \end{codebox}
    \caption{Multi-core algorithm for a convolutional layer using direct
      convolution.}
    \label{alg:cpu_direct}
    }
  \end{algorithm}
